<!--
  ~ Copyright (C) 2010 Brockmann Consult GmbH (info@brockmann-consult.de)
  ~
  ~ This program is free software; you can redistribute it and/or modify it
  ~ under the terms of the GNU General Public License as published by the Free
  ~ Software Foundation; either version 3 of the License, or (at your option)
  ~ any later version.
  ~ This program is distributed in the hope that it will be useful, but WITHOUT
  ~ ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  ~ FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
  ~ more details.
  ~
  ~ You should have received a copy of the GNU General Public License along
  ~ with this program; if not, see http://www.gnu.org/licenses/
  -->

<html>
<head>
    <title>Idepix S2 MSI Processor Description</title>
    <link rel="stylesheet" href="../style.css">
</head>

<body>

<table class="header">
    <tr class="header">
        <td class="header">&nbsp;
            S2 MSI - Processor Description
        </td>
        <td class="header" align="right"><a
                href="nbdocs://org.esa.snap.snap.help/org/esa/snap/snap/help/docs/general/overview/SnapOverview.html"><img
                src="../images/snap_header.jpg"
                border=0></a>
        </td>
    </tr>
</table>

<h3>Processor Description</h3>

<h4>I/O Parameters Tab</h4>

<p align="center"><img src="images/IdepixPathsSen2Msi.png"></p>

<h5>Source Product Group</h5>

<p class="i1">
    <b>Sentinel-2 MSI L1C product: </b>
    Used to select the spectral source product. The source product shall
    contain spectral bands providing a source spectrum at each pixel. Use the <b>...</b> button to
    open a data product currently not opened in the Sentinel Toolbox.
</p>

For product descriptions and file naming conventions see the Sentinel-2 MSI Product User Guide
(https://sentinel.esa.int/web/sentinel/user-guides/sentinel-2-msi/product-types/level-1c).

<h5>Target Product Group</h5>

<p class="i1">
    <b>Name:</b>
    Used to specify the name of the target product.
</p>

<p class="i1">
    <b>Save to:</b>
    Used to specify whether the target product should be saved to the file system. The
    combo box presents a list of file formats.
</p>

<p class="i1">
    <b>Open in SNAP:</b>
    Used to specify whether the target product should be opened in the Sentinel Toolbox.
    When the target product is not saved, it is opened in the Sentinel Toolbox automatically.
</p>

<h3>The Processing Parameters</h3>

<p align="center"><img src="images/IdepixParameterSen2.png"></p>

<p class="i1">
    <b>Write TOA reflectances to the target product: </b><br>
    Whether to add the TOA reflectance bands from the source L1C product to the target idepix product
</p>

<p class="i1">
    <b>Write feature values to the target product: </b><br>
    If true, the following bands will additionally be written to the target product:
<ul>
    <li>
        bright_value: Brightness
    </li>
    <li>
        bright_white_value: Whiteness
    </li>
    <li>
        bright_value: Brightwhiteness
    </li>
    <li>
        spectral_flatness_value: Spectral Flatness
    </li>
    <li>
        ndvi_value: NDVI
    </li>
    <li>
        ndsi_value: NDSI
    </li>
    <li>
        radiometric_land_value: Radiometric Land Value
    </li>
    <li>
        radiometric_water_value: Radiometric Water Value
    </li>
    <li>
        b3b11_value: B3 B11 Value
    </li>
    <li>
        tc1_value: TC1 Value
    </li>
    <li>
        tc4_value: TC4 Value
    </li>
    <li>
        tc4cirrus_water_value: TC4 Cirrus Value
    </li>
    <li>
        ndwi_value: NDWI Value
    </li>
</ul>

<p class="i1">
    <b>Compute mountain shadow: </b><br>
    Whether to additionally compute a mountain shadow flag.
</p>

<p class="i1">
    <b>Compute cloud shadow: </b><br>
    Whether to additionally compute a cloud shadow flag.
</p>

<p class="i1">
    <b>Compute a cloud buffer: </b><br>
    Whether to leave an additional buffer around cluds during computation.
    This buffer will be displayed as an extra flag and will be considered during the computation of, e.g., cloud shadow.
</p>

<p class="i1">
    <b>Compute a cloud buffer also for cloud ambiguous pixles: </b><br>
    Whether the buffer shall also be applied to pixels that have not unambiguously been identified as cloud.
</p>

<p class="i1">
    <b>Width of cloud buffer (# of pixels): </b><br>
    The width of the cloud buffer in pixels.
    This value is only considered when cloud buffer computation has been selected.
</p>

<p class="i1">
    <b>Digital Elevation Model: </b><br>
    The IdePix processor will compute an elevation band and add it to the target product.
    Here, you can specify which Digital Elevation Model shall be used for this.
    Applicable Models are:
</p>
<ul>
    <li>
        ACE2_5Min
    </li>
    <li>
        ACE30
    </li>
    <li>
        ASTER 1sec GDEM
    </li>
    <li>
        CDEM
    </li>
    <li>
        GETASSE30
    </li>
    <li>
        SRTM 1Sec Grid
    </li>
    <li>
        SRTM 1Sec Hgt
    </li>
    <li>
        SRTM 3Sec (Default)
    </li>
</ul>
<br>

<h3>The Processing Result</h3>
The Idepix classification result is written into the target product as a flag band named 'pixel_classif_flags'.
This band holds integer values which for Sentinel-2 MSI follow the flag coding shown below.

<p align="center">
    <img src="images/Sen2MsiFlagCoding.png" border="0">
</p>
<br>

The target product also provides a corresponding flag mask to visualize the pixel classification through the
SNAP Mask Manager:

<p align="center">
    <img src="images/Sen2MsiMaskManager.png" border="0">
</p>


<hr>
</body>
</html>